{"ast":null,"code":"import _objectSpread from\"C:/Users/Farhan/Desktop/WebDevelopment/Projects/Learnify/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"C:/Users/Farhan/Desktop/WebDevelopment/Projects/Learnify/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"C:/Users/Farhan/Desktop/WebDevelopment/Projects/Learnify/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/Farhan/Desktop/WebDevelopment/Projects/Learnify/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useEffect,useState}from\"react\";import{useForm}from\"react-hook-form\";import{useDispatch,useSelector}from\"react-redux\";import{useNavigate}from\"react-router-dom\";import{editCourseDetails}from\"../../../../../services/operations/courseDetailsAPI\";import{resetCourseState,setStep}from\"../../../../../slices/courseSlice\";import{COURSE_STATUS}from\"../../../../../utils/constants\";import IconBtn from\"../../../../common/IconBtn\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function PublishCourse(){var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit,setValue=_useForm.setValue,getValues=_useForm.getValues;var dispatch=useDispatch();var navigate=useNavigate();var _useSelector=useSelector(function(state){return state.auth;}),token=_useSelector.token;var _useSelector2=useSelector(function(state){return state.course;}),course=_useSelector2.course;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),loading=_useState2[0],setLoading=_useState2[1];useEffect(function(){if((course===null||course===void 0?void 0:course.status)===COURSE_STATUS.PUBLISHED){setValue(\"public\",true);}},[]);var goBack=function goBack(){dispatch(setStep(2));};var goToCourses=function goToCourses(){dispatch(resetCourseState());navigate(\"/dashboard/my-courses\");};var handleCoursePublish=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var formData,courseStatus,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:if(!((course===null||course===void 0?void 0:course.status)===COURSE_STATUS.PUBLISHED&&getValues(\"public\")===true||(course===null||course===void 0?void 0:course.status)===COURSE_STATUS.DRAFT&&getValues(\"public\")===false)){_context.next=3;break;}// form has not been updated\n// no need to make api call\ngoToCourses();return _context.abrupt(\"return\");case 3:formData=new FormData();formData.append(\"courseId\",course._id);courseStatus=getValues(\"public\")?COURSE_STATUS.PUBLISHED:COURSE_STATUS.DRAFT;formData.append(\"status\",courseStatus);setLoading(true);_context.next=10;return editCourseDetails(formData,token);case 10:result=_context.sent;if(result){goToCourses();}setLoading(false);case 13:case\"end\":return _context.stop();}},_callee);}));return function handleCoursePublish(){return _ref.apply(this,arguments);};}();var onSubmit=function onSubmit(data){// console.log(data)\nhandleCoursePublish();};return/*#__PURE__*/_jsxs(\"div\",{className:\"rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\",children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-2xl font-semibold text-richblack-5\",children:\"Publish Settings\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),children:[/*#__PURE__*/_jsx(\"div\",{className:\"my-6 mb-8\",children:/*#__PURE__*/_jsxs(\"label\",{htmlFor:\"public\",className:\"inline-flex items-center text-lg\",children:[/*#__PURE__*/_jsx(\"input\",_objectSpread(_objectSpread({type:\"checkbox\",id:\"public\"},register(\"public\")),{},{className:\"border-gray-300 h-4 w-4 rounded bg-richblack-500 text-richblack-400 focus:ring-2 focus:ring-richblack-5\"})),/*#__PURE__*/_jsx(\"span\",{className:\"ml-2 text-richblack-400\",children:\"Make this course as public\"})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"ml-auto flex max-w-max items-center gap-x-4\",children:[/*#__PURE__*/_jsx(\"button\",{disabled:loading,type:\"button\",onClick:goBack,className:\"flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900\",children:\"Back\"}),/*#__PURE__*/_jsx(IconBtn,{disabled:loading,text:\"Save Changes\"})]})]})]});}","map":{"version":3,"names":["useEffect","useState","useForm","useDispatch","useSelector","useNavigate","editCourseDetails","resetCourseState","setStep","COURSE_STATUS","IconBtn","jsx","_jsx","jsxs","_jsxs","PublishCourse","_useForm","register","handleSubmit","setValue","getValues","dispatch","navigate","_useSelector","state","auth","token","_useSelector2","course","_useState","_useState2","_slicedToArray","loading","setLoading","status","PUBLISHED","goBack","goToCourses","handleCoursePublish","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","formData","courseStatus","result","wrap","_callee$","_context","prev","next","DRAFT","abrupt","FormData","append","_id","sent","stop","apply","arguments","onSubmit","data","className","children","htmlFor","_objectSpread","type","id","disabled","onClick","text"],"sources":["C:/Users/Farhan/Desktop/WebDevelopment/Projects/Learnify/src/components/core/Dashboard/AddCourse/PublishCourse/index.jsx"],"sourcesContent":["import { useEffect, useState } from \"react\"\nimport { useForm } from \"react-hook-form\"\nimport { useDispatch, useSelector } from \"react-redux\"\nimport { useNavigate } from \"react-router-dom\"\n\nimport { editCourseDetails } from \"../../../../../services/operations/courseDetailsAPI\"\nimport { resetCourseState, setStep } from \"../../../../../slices/courseSlice\"\nimport { COURSE_STATUS } from \"../../../../../utils/constants\"\nimport IconBtn from \"../../../../common/IconBtn\"\n\nexport default function PublishCourse() {\n  const { register, handleSubmit, setValue, getValues } = useForm()\n\n  const dispatch = useDispatch()\n  const navigate = useNavigate()\n  const { token } = useSelector((state) => state.auth)\n  const { course } = useSelector((state) => state.course)\n  const [loading, setLoading] = useState(false)\n\n  useEffect(() => {\n    if (course?.status === COURSE_STATUS.PUBLISHED) {\n      setValue(\"public\", true)\n    }\n  }, [])\n\n  const goBack = () => {\n    dispatch(setStep(2))\n  }\n\n  const goToCourses = () => {\n    dispatch(resetCourseState())\n    navigate(\"/dashboard/my-courses\")\n  }\n\n  const handleCoursePublish = async () => {\n    // check if form has been updated or not\n    if (\n      (course?.status === COURSE_STATUS.PUBLISHED &&\n        getValues(\"public\") === true) ||\n      (course?.status === COURSE_STATUS.DRAFT && getValues(\"public\") === false)\n    ) {\n      // form has not been updated\n      // no need to make api call\n      goToCourses()\n      return\n    }\n    const formData = new FormData()\n    formData.append(\"courseId\", course._id)\n    const courseStatus = getValues(\"public\")\n      ? COURSE_STATUS.PUBLISHED\n      : COURSE_STATUS.DRAFT\n    formData.append(\"status\", courseStatus)\n    setLoading(true)\n    const result = await editCourseDetails(formData, token)\n    if (result) {\n      goToCourses()\n    }\n    setLoading(false)\n  }\n\n  const onSubmit = (data) => {\n    // console.log(data)\n    handleCoursePublish()\n  }\n\n  return (\n    <div className=\"rounded-md border-[1px] border-richblack-700 bg-richblack-800 p-6\">\n      <p className=\"text-2xl font-semibold text-richblack-5\">\n        Publish Settings\n      </p>\n      <form onSubmit={handleSubmit(onSubmit)}>\n        {/* Checkbox */}\n        <div className=\"my-6 mb-8\">\n          <label htmlFor=\"public\" className=\"inline-flex items-center text-lg\">\n            <input\n              type=\"checkbox\"\n              id=\"public\"\n              {...register(\"public\")}\n              className=\"border-gray-300 h-4 w-4 rounded bg-richblack-500 text-richblack-400 focus:ring-2 focus:ring-richblack-5\"\n            />\n            <span className=\"ml-2 text-richblack-400\">\n              Make this course as public\n            </span>\n          </label>\n        </div>\n\n        {/* Next Prev Button */}\n        <div className=\"ml-auto flex max-w-max items-center gap-x-4\">\n          <button\n            disabled={loading}\n            type=\"button\"\n            onClick={goBack}\n            className=\"flex cursor-pointer items-center gap-x-2 rounded-md bg-richblack-300 py-[8px] px-[20px] font-semibold text-richblack-900\"\n          >\n            Back\n          </button>\n          <IconBtn disabled={loading} text=\"Save Changes\" />\n        </div>\n      </form>\n    </div>\n  )\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}